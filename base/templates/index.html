{% extends "allauth/layouts/base.html" %} {% load allauth humanize static %} 
{% block head_title %}Money Exchange Platform{% endblock %} {% block head_extra %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="py-5 text-center text-white" style="background: linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)">
  <div class="container">
    <h1 class="display-3 fw-bold">Money Exchange Platform</h1>
    <p class="lead my-4">
      Connecting Uzbek expats to send and receive money seamlesslyâ€”no fees, no commissions, no middlemen.
    </p>
    <a href="#offers" class="btn btn-lg btn-light shadow">Get Started</a>
  </div>
</section>

<!-- Offers Section -->
<section id="offers" class="py-5">
  <div class="container">
    <!-- Quick Navigation Cards -->
    <div class="row text-center mb-5">
      <div class="col-md-6 mb-3">
        <div class="card border-0 shadow h-100">
          <div class="card-body d-flex flex-column">
            <i class="bi bi-arrow-right-circle-fill text-primary display-4 mb-3"></i>
            <h3 class="card-title fw-bold">Send Money</h3>
            <p class="card-text flex-grow-1">Looking to send money to Uzbekistan? Find expats who need funds.</p>
            <a href="#sendOffers" class="btn btn-outline-primary mt-3">View Offers</a>
          </div>
        </div>
      </div>
      <div class="col-md-6 mb-3">
        <div class="card border-0 shadow h-100">
          <div class="card-body d-flex flex-column">
            <i class="bi bi-arrow-left-circle-fill text-success display-4 mb-3"></i>
            <h3 class="card-title fw-bold">Receive Money</h3>
            <p class="card-text flex-grow-1">Need to receive money from Uzbekistan? Connect with senders instantly.</p>
            <a href="#receiveOffers" class="btn btn-outline-success mt-3">View Offers</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Offers to Send Money to Uzbekistan -->
    <div class="mb-5">
      <h2 id="sendOffers" class="fw-bold text-primary mb-4">Offers to Send Money to Uzbekistan</h2>
      <div class="row">
        {% for req in send_requests %}
        <div class="col-md-6 col-lg-4 mb-4">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
              <span>
                {% if req.user == user %}
                <strong class="text-warning">{{ req.user.username }} (You)</strong>
                {% else %} {{ req.user.username }} {% endif %}
              </span>
              <span class="badge bg-light text-primary">{{ req.currency }}</span>
            </div>
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-arrow-right-circle-fill text-primary me-2"></i>
                Send: {{ req.amount|intcomma }} JPY
              </h5>
              <p class="card-text">
                <strong>Deadline:</strong> {{ req.deadline }} {% if req.urgent %}
                <span class="badge bg-danger ms-2">Urgent</span>
                {% endif %}
              </p>
              <p class="card-text">
                <strong>Conditions:</strong>
                <span class="d-block mt-1">{{ req.conditions|default:"None"|linebreaks }}</span>
              </p>
              {% if not req.hide_contacts %}
              <p class="card-text">
                <strong>Contact:</strong>
                <a href="mailto:{{ req.user.profile.contact_info }}" class="text-primary">
                  <i class="bi bi-envelope-fill me-1"></i>{{ req.user.profile.contact_info }}
                </a>
              </p>
              {% else %}
              <p class="card-text text-muted">
                <i class="bi bi-lock-fill me-1"></i>Contact information hidden. Use the message form to connect.
              </p>
              {% endif %}
            </div>
            {% if req.user != user %}
            <div class="card-footer text-center">
              <a href="{% url 'start_conversation' req.id %}" class="btn btn-outline-primary">
                <i class="bi bi-chat-fill me-2"></i> Start Conversation
              </a>
            </div>
            {% endif %}
          </div>
        </div>
        {% empty %}
        <div class="col-12">
          <div class="alert alert-warning text-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>No active send requests available.
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- Offers to Receive Money from Uzbekistan -->
    <div>
      <h2 id="receiveOffers" class="fw-bold text-success mb-4">Offers to Receive Money from Uzbekistan</h2>
      <div class="row">
        {% for req in receive_requests %}
        <div class="col-md-6 col-lg-4 mb-4">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
              <span>
                {% if req.user == user %}
                <strong class="text-warning">{{ req.user.username }} (You)</strong>
                {% else %} {{ req.user.username }} {% endif %}
              </span>
              <span class="badge bg-light text-success">{{ req.currency }}</span>
            </div>
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-arrow-left-circle-fill text-success me-2"></i>
                Receive: {{ req.amount|intcomma }} JPY
              </h5>
              <p class="card-text">
                <strong>Deadline:</strong> {{ req.deadline }} {% if req.urgent %}
                <span class="badge bg-danger ms-2">Urgent</span>
                {% endif %}
              </p>
              <p class="card-text">
                <strong>Conditions:</strong>
                <span class="d-block mt-1">{{ req.conditions|default:"None"|linebreaks }}</span>
              </p>
              {% if not req.hide_contacts %}
              <p class="card-text">
                <strong>Contact:</strong>
                <a href="mailto:{{ req.user.profile.contact_info }}" class="text-primary">
                  <i class="bi bi-envelope-fill me-1"></i>{{ req.user.profile.contact_info }}
                </a>
              </p>
              {% else %}
              <p class="card-text text-muted">
                <i class="bi bi-lock-fill me-1"></i>Contact information hidden. Use the message form to connect.
              </p>
              {% endif %}
            </div>
            {% if req.user != user %}
            <div class="card-footer text-center">
              <a href="{% url 'start_conversation' req.id %}" class="btn btn-outline-success">
                <i class="bi bi-chat-fill me-2"></i> Start Conversation
              </a>
            </div>
            {% endif %}
          </div>
        </div>
        {% empty %}
        <div class="col-12">
          <div class="alert alert-warning text-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>No active receive requests available.
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Call to Action -->
  <div class="container my-5">
    <div class="row justify-content-center align-items-center">
      <div class="col-md-6 text-center">
        <img src="{% static "/post.svg" %}" alt="Post an Offer" class="img-fluid mb-4" style="max-width: 300px;">
        <h3 class="fw-bold text-primary">Didn't find a suitable offer?</h3>
        <p class="lead mb-4">
          Take the initiative to post your own offer and connect with others looking to exchange money.
        </p>
        <a href="{% url 'create_request' %}" class="btn btn-primary btn-lg">Post an Offer</a>
      </div>
    </div>
  </div>
  <hr />
  <!-- Features Section -->
  <div class="container my-5">
    <h2 class="text-center mb-4">Why Choose Us?</h2>
    <div class="row">
      <div class="col-md-4 text-center">
        <i class="bi bi-piggy-bank display-4 text-primary"></i>
        <h3 class="mt-3">No Fees</h3>
        <p>Exchange money without any commissions or hidden charges.</p>
      </div>
      <div class="col-md-4 text-center">
        <i class="bi bi-link display-4 text-primary"></i>
        <h3 class="mt-3">Direct Connection</h3>
        <p>Connect directly with other users through our secure chat system.</p>
      </div>
      <div class="col-md-4 text-center">
        <i class="bi bi-shield-lock display-4 text-primary"></i>
        <h3 class="mt-3">Secure</h3>
        <p>Your data is protected, and we don't handle any money transfers.</p>
      </div>
    </div>
  </div>

  <hr />

  <!-- How It Works Section -->
  <div class="container my-5">
    <h2 class="text-center mb-4">How It Works</h2>
    <div class="row">
      <div class="col-md-4 text-center">
        <i class="bi bi-pencil-square display-4 text-success"></i>
        <h3 class="mt-3">1. Post Your Offer</h3>
        <p>Create an offer to send or receive money with your preferred terms.</p>
      </div>
      <div class="col-md-4 text-center">
        <i class="bi bi-people display-4 text-success"></i>
        <h3 class="mt-3">2. Connect with Others</h3>
        <p>Browse offers and start a conversation with potential matches.</p>
      </div>
      <div class="col-md-4 text-center">
        <i class="bi bi-cash display-4 text-success"></i>
        <h3 class="mt-3">3. Exchange Money</h3>
        <p>Agree on terms and complete the transaction securely.</p>
      </div>
    </div>
  </div>
</section>

{% endblock content %}
