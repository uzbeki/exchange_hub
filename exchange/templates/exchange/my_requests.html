{% extends "allauth/layouts/entrance.html" %} {% load static allauth %} {% block head_title %}My Requests{% endblock %}
{% block content %}
<h1>My Requests</h1>
<div class="container">
  {% for req in requests %}
  <div class="card mb-3">
    <!-- Card Header: Request Type -->
    <div class="card-header">
      <h5 class="mb-0">{{ req.type }}</h5>
    </div>
    <!-- Card Body: Request Details -->
    <ul class="list-group list-group-flush">
      <li class="list-group-item d-flex justify-content-between">
        <span>Amount</span>
        <span>{{ req.amount }} {{ req.currency }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>Deadline</span>
        <span>{{ req.deadline }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>Status</span>
        <span
          class="badge {% if req.status == 'active' %}bg-warning{% elif req.status == 'completed' %}bg-success{% else %}bg-secondary{% endif %}"
        >
          {{ req.status }}
        </span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>Conversations</span>
        <span><i class="bi bi-chat"></i> {{ req.conversations.count }}</span>
      </li>
    </ul>
    <!-- Card Footer: Action Buttons -->
    <div class="card-footer d-flex justify-content-end gap-2">
      {% if req.status == 'active' %}
      <form method="post" action="{% url 'complete_request' req.id %}" class="d-inline-block">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary"><i class="bi bi-check-circle"></i> Mark as Completed</button>
      </form>
      {% endif %}
      <form method="post" action="{% url 'delete_request' req.id %}" class="d-inline-block">
      {% comment %} <form method="post" action="#" class="d-inline-block"> {% endcomment %}
        {% csrf_token %}
        <button type="submit" class="btn btn-danger"><i class="bi bi-trash"></i> Delete</button>
      </form>
    </div>
  </div>
  {% empty %}
  <!-- Empty State -->
  <div class="card">
    <div class="card-body text-center">No requests yet.</div>
  </div>
  {% endfor %}
</div>
{% endblock %}
